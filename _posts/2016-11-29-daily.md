---
title: 每日总结 2016-11-29
author: Li Xiang
date: 2016-11-29
layout: post
tags: [JavaScript,R,Data viz,Data science]
categories: [Daily]
description: "JS 包括引用类型中的包装类型和内置对象。你不知道的JS之作用域。看了学晴数据网上的通过R进行地理信息数据可视化的教学视频。报了个免费基础数据挖掘教程“全栈数据工程师养成”。"
---

# JavaScript

## 基本包装类型 ##

ECMAScript 提供了3个特殊的引用类型：Boolean、Number 和 String。
引用类型与基本包装类型的主要区别就是**对象的生存期**。
> 使用 new 操作符创建的引用类型的实例，在执行流离开当前作用域之前都一直保存在内存中。而自动创建的基本包装类型的对象，则只存在于一行代码的执行瞬间，然后立即被销毁。这意味着不能在运行时为基本类型值添加属性和方法。

使用 new 调用基本包装类型的构造函数，与直接调用同名的转型函数不一样。使用转型函数得到的对象仍然为基本类型。
不建议显式地创建基本包装类型的对象。

### Boolean 类型 ###

基本类型与引用类型的布尔值的区别：
- 布尔表达式中的所有对象都会被转换为 true，所以即便 Boolean 对象的值为 false，在布尔表达式中仍然为 true。
- typeof 操作符对基本类型返回 "boolean"，而对引用类型返回 "object"。
- 由于 Boolean 对象是 Boolean 类型的实例，所以使用 instanceof 操作符测试 Boolean 对象会返回 true，而测试基本类型的布尔值则返回 false。

### Number 类型 ###

Number 类型提供了操作数值的方法。
- `toExponential` 返回指数（科学记数法）表示方法的数值的字符串。
- `toFixed()` 返回固定小数点位数表示方法的数值的字符串。
- `toPrecision()` 返回特定精度的数值的字符串。
- `valueOf()` 返回基本类型值
- `toLocaleString()` `toString()` 返回数值的字符串表示。

### String 类型 ###

String 类型实例同样继承了 `valueOf()` `toLocaleString()` `toString()` 方法，都返回对象所表示的基本字符串值。

**字符方法**
两个用于访问字符串中特定字符的方法：`charAt()` 和 `charCodeAt()`，两个方法都接收一个参数，即基于0的字符位置。
ECMAScript 5定义了另一个访问个别字符的方法，在支持此方法的浏览器中，可以使用方括号加数字索引来反问字符串中的特定字符。

**字符串操作方法**
拼接字符串 `concat()`，该方法可以接受任意多个参数。
三个基于子字符串创建新字符串的方法：`slice()` `substr()` `substring()`。
字符串位置方法：`indexOf()` `lastIndexOf()`
`trim()` 方法：删除前置及后缀的所有空格。
大小写转换方法：`toLowerCase()` `toLocaleLowerCase()` `toUpperCase()` `toLocaleUpperCase()`
模式匹配方法：`match()` `search()` `replace()` `split()`
`localeCompare()`：比较两个字符串，并返回-1，0，或1。
`fromCharCode()`：接收一或多个字符编码，然后将它们转换成一个字符串。

## 单体内置对象 ##

**内置对象**：由 ECMAScript 实现提供的、不依赖于宿主环境的对象，这些对象在 ECMAScript 程序执行之前就已经存在了。开发者不必显式地实例化内置对象，因为它们已经被实例化了。

### Global 对象 ###

不属于任何其他对象的属性和方法，最终都是 Global 对象的属性和方法。事实上，没有全局变量或全局函数；所有在全局作用域中定义的属性和函数，都是 Global 对象的属性。

URI 编码方法
`encodeURI()` `encodeURIComponent()` 方法可以对 URI (Uniform Resource Identifiers, 通用资源标识符) 进行编码，以便发送给浏览器。有效的 URI 中不能包含某些字符，于是这两个方法就对 URI 进行编码，使用特殊的 UTF-8 编码替换掉所有无效的字符，从而让浏览器能够接受和理解。

`decodeURI()` `decodeURIComponent()` 解码方法和编码方法相对应。

`eval()` 方法像是一个完整的 ECMAScript 解析器，只接受一个参数，即要执行的 ECMAScript 字符串。

### Math 对象 ###

Math 对象的属性，大多是数学计算中可能会用到的一些特殊值。
`min()` 和 `max()` 方法
舍入方法：`Math.ceil()` `Math.floor()` `Math.round()`
`random()` 方法返回大于等于0小于1的一个随机数。
要得到特定范围的随机值 `值 = Math.floor(Math.random() * 可能值的总数 + 第一个可能的值)`

## 总结 ##

学习 JavaScript 编程基础已有一段时间，觉得 JavaScript 的难点在于几个难以理解的抽象概念和应对一些语言设计上的“坑”。理解了 JS 语言中的这几个概念，例如，对象，类，原型，原型链，作用域，闭包，继承等，也就算是入门了吧。实际上，这些概念也就是面向对象和函数式编程语言对于初学编程的人来说难以理解的点。只不过在 JS 上，有其特殊性。

---

# JavaScript 作用域

来源：你不知道的 JS 上 --- 作用域

传统编译语言的流程中，源码在执行前会经历三个步骤（编译）：
- **分词/词法分析（Tokenizing/Lexing）**：将由字符组成的字符串分解成有意义的代码块（词法单元）。
- **解析/语法分析（Parsing）**：将词法单元流（数组）转换成一个由元素逐级嵌套所组成的代表了程序语法结构的数（抽象语法树，Abstract Syntax Tree, AST）。
- **代码生成**：将 AST 转换为可执行代码。

对 JS 来说，大部分情况下编译发生在代码执行前的几微秒（甚至更短！）的时间内。任何 JS 代码片段在执行前都要进行编译。编译后通常马上执行它。

代码编译到执行关键的三个部件：
- **引擎**：从头到尾负责整个 JS 程序的编译及执行过程。
- **编译器**：负责语法分析及代码生成等。
- **作用域**：负责收集并维护有所有声明的标识符（变量）组成的一系列查询，并实施一套非常严格的规则，确定当前执行的代码对这些标识符的访问权限。

**变量的赋值操作**会执行两个动作，首先编译器会在当前作用域中声明一个变量（如果之前没有声明过），然后在运行时引擎会在作用域中查找该变量，如果能够找到就会对它赋值。

理解两种查询方式：
- **LHS 查询**，视图找到变量的容器本身，然后对其赋值。赋值操作的目标是谁？
- **RHS 查询**，取到它的源值，意味着得到某某的值。谁是赋值操作的源头？

当变量出现在赋值操作的左侧时，进行 LHS 查询，出现在右侧（非左侧）则进行 RHS 查询。RHS 查询与简单地查找某个变量的值别无二致，而 LHS 查询则是视图找到变量的容器本身，从而可以对其赋值。

当一个块或函数嵌套在另一个块或函数中时，就发生了作用域的嵌套。
**遍历嵌套作用域链**：引擎从当前的执行作用域开始查找变量，如果找不到，就向上一级继续查找。当抵达最外层的全局作用域时，无论找到与否，查找过程都会停止。

**ReferenceError**
如果 RHS 查询在所有嵌套的作用域中遍寻不到所需的变量，引擎就会抛出 ReferenceError 异常。但是，当引擎执行 LHS 查询时，如果在顶层中也无法找到目标变量，全局作用域中就会创建一个具有该名称的变量，并将其返还给引擎，前提是程序运行在非“严格模式”下。在严格模式下，会禁止自动或隐式地创建全局变量。因此，在严格模式中 LHS 查询失败时，并不会创建并返回一个全局变量，引擎同样抛出 ReferenceError 异常。

**TypeError**
如果 RHS 查询找到了一个变量，但是你尝试对这个变量的值进行不合理的操作，比如视图对一个非函数类型的值进行函数调用，或者引用 null 或 undefined 类型的值中的属性，那么引擎会抛出另外一种类型的异常，叫作 TypeError。

总结：作用域是学习编程过程中需要着重理解的概念之一。

# 数据科学

## R 地理信息可视化 ##

看了 REmap 包的开发者[郎大为](http://lchiffon.github.io/about/)在[雪晴数据网](http://www.xueqing.tv/)上所做的 REmap 基本教程。了解了一些地理信息可视化包。

静态地理信息：
- maps：较老
- ggmap：需科学上网
- choroplethr：国外比较火
交互地理信息：
- leaflet
- googleVis
辅助的 R 包：
- RgoogleMaps
- mapdata
- mapproj
- baidumap：与 ggplot2 结合

[REmap](https://github.com/lchiffon/REmap) 是一个基于 Echarts 的 R 包，提供了一个简便，可交互的地图数据可视化工具。

安装：`devtools::install_github('lchiffon/REmap')`

关于数据产品
- 数据驱动
- 建模预测
- 较好的可视化

## 数据工程师 ##

在学晴网上还报了个免费的数据工程师入门系列教程---[全栈数据工程师养成攻略](http://www.xueqing.tv/course/73)，可以稍微走一个整体的简单数据挖掘的流程，特别是我还未实际操作过的领域，比如爬虫，与数据库交互，交互式数据可视化，Processing 可视化等。
